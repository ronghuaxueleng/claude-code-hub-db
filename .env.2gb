# ============================================
# Claude Code Hub - 2GB 内存服务器优化配置
# ============================================

# 管理员令牌（必须修改！）
ADMIN_TOKEN=change-me-to-secure-token

# 自动迁移
AUTO_MIGRATE=true

# 数据库配置
DB_USER=postgres
DB_PASSWORD=your-secure-password-change-me
DB_NAME=claude_code_hub

# 数据库连接池优化（2GB 内存服务器）
DB_POOL_MAX=10                              # 降低连接池大小（默认 20）
DB_POOL_IDLE_TIMEOUT=30                     # 增加空闲超时，减少频繁创建连接
DB_POOL_CONNECT_TIMEOUT=10

# 异步批量写入（重要：降低数据库压力）
MESSAGE_REQUEST_WRITE_MODE=async
MESSAGE_REQUEST_ASYNC_FLUSH_INTERVAL_MS=500  # 增加批量间隔
MESSAGE_REQUEST_ASYNC_BATCH_SIZE=100         # 减少批量大小
MESSAGE_REQUEST_ASYNC_MAX_PENDING=2000       # 降低最大待处理数

# 应用配置
APP_PORT=23000
APP_URL=                                     # 填写你的服务器 IP 或域名

# API 测试超时
API_TEST_TIMEOUT_MS=15000

# Cookie 安全策略
ENABLE_SECURE_COOKIES=false                  # 如果使用 HTTP 访问，设置为 false

# Redis 配置（重要：启用限流和缓存，启用密码保护）
ENABLE_RATE_LIMIT=true
REDIS_PASSWORD=your-redis-password-change-me
REDIS_URL=redis://:your-redis-password-change-me@redis:6379

# Session 配置（优化内存使用）
SESSION_TTL=300                              # 5 分钟缓存
STORE_SESSION_MESSAGES=false                 # 关闭消息存储（节省 Redis 内存）

# 熔断器配置
ENABLE_CIRCUIT_BREAKER_ON_NETWORK_ERRORS=false

# 供应商缓存（重要：减少数据库查询）
ENABLE_PROVIDER_CACHE=true

# 超时配置（优化响应速度）
FETCH_CONNECT_TIMEOUT=15000                  # 降低连接超时（快速失败）
FETCH_HEADERS_TIMEOUT=300000                 # 5 分钟
FETCH_BODY_TIMEOUT=300000                    # 5 分钟
MAX_RETRY_ATTEMPTS_DEFAULT=2

# 智能探测（可选，会增加少量开销）
ENABLE_SMART_PROBING=false
PROBE_INTERVAL_MS=60000                      # 如果启用，增加探测间隔
PROBE_TIMEOUT_MS=5000

# 多提供商类型支持
ENABLE_MULTI_PROVIDER_TYPES=false
